# OCM - OpenClaw Cluster Manager è®¾è®¡æ–‡æ¡£

> Version: 0.6 (Botæ§åˆ¶å±‚ + ç¨³å®šæ€§å¢å¼º)
> Author: Work Bot
> Date: 2026-02-15

---

## 1. é¡¹ç›®æ¦‚è¿°

ç®¡ç†å¤šå° OpenClaw èŠ‚ç‚¹çš„ Web åº”ç”¨ã€‚æ”¯æŒä¸€é”®éƒ¨ç½²ã€Git å¤‡ä»½ã€æ™ºåŠ›ç›‘æ§ã€è‡ªåŠ¨å›æ»šã€‚

**ç›®æ ‡èŠ‚ç‚¹ï¼š** 5Ã— G3S (N95) + 2Ã— Mac mini = 7å°ï¼Œæœªæ¥æ‰©å±•åˆ°20å°

---

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„ (v6 - Botåˆ¶å¾¡å±¤è¿½åŠ )

**æ ¸å¿ƒç†å¿µ: Bot â†’ OCM â†’ Nodes ä¸‰å±‚æ§åˆ¶**

```
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ§åˆ¶å±‚ (Master)                      â”‚
  â”‚                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ ğŸ¤– OCM Bot  â”‚â”€â”€â”€â”€â†’â”‚    OCM Server (API)      â”‚  â”‚
  â”‚  â”‚ (OpenClaw)  â”‚ API â”‚  Node.js + Express        â”‚  â”‚
  â”‚  â”‚             â”‚     â”‚                            â”‚  â”‚
  â”‚  â”‚ Telegram    â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
  â”‚  â”‚ è‡ªç„¶è¯­è¨€æŒ‡ä»¤ â”‚     â”‚  â”‚ Cron â”‚ â”‚ SSH Pool    â”‚ â”‚  â”‚
  â”‚  â”‚             â”‚     â”‚  â”‚      â”‚ â”‚ Git Manager â”‚ â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚      â”‚ â”‚ Alerter     â”‚ â”‚  â”‚
  â”‚         â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
  â”‚         â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                  â”‚                  â”‚
  â”‚  â”‚ OCM Web UI  â”‚ (äººå·¥æ“ä½œå…¥å£)    â”‚                  â”‚
  â”‚  â”‚ Dashboard   â”‚                  â”‚                  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ SSH (key-based)
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                       â–¼                  â–¼
```

**ä¸‰å±‚æ§åˆ¶çš„ç¨³å®šæ€§ä¼˜åŠ¿:**

| å±‚ | ç»„ä»¶ | èŒè´£ | æ•…éšœå½±å“ |
|----|------|------|---------|
| L1 | OCM Bot (Telegram) | æ¥æ”¶æŒ‡ä»¤ã€å‘Šè­¦é€šçŸ¥ | Bot æŒ‚äº†â†’Web UI ä»å¯ç”¨ |
| L2 | OCM Server (API) | ä¸šåŠ¡é€»è¾‘ã€å®šæ—¶ä»»åŠ¡ | Server æŒ‚äº†â†’èŠ‚ç‚¹ä»ç‹¬ç«‹è¿è¡Œ |
| L3 | å„ Node (OpenClaw) | å®é™… AI æœåŠ¡ | å•èŠ‚ç‚¹æŒ‚â†’å…¶ä»–èŠ‚ç‚¹ä¸å—å½±å“ |

**æ§åˆ¶æµå‘:**
```
ç”¨æˆ· â†’ Telegram Bot "å¤‡ä»½ g3s-01"
  â†’ OCM Bot è§£ææŒ‡ä»¤
    â†’ è°ƒç”¨ OCM API: POST /api/nodes/g3s-01/backups
      â†’ OCM Server SSH â†’ g3s-01 æ‰§è¡Œå¤‡ä»½
        â†’ Git commit + push â†’ GitHub
          â†’ ä¸Šä¼  â†’ Google Drive
  â†’ OCM Bot å›å¤ "âœ… g3s-01 å¤‡ä»½å®Œæˆï¼Œcommit: abc123"
```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Node 1   â”‚    â”‚ Node 2   â”‚ ...  â”‚ Node 7   â”‚
        â”‚ G3S-01   â”‚    â”‚ G3S-02   â”‚      â”‚ Mac mini â”‚
        â”‚          â”‚    â”‚          â”‚      â”‚          â”‚
        â”‚ ocm-agentâ”‚    â”‚ ocm-agentâ”‚      â”‚ ocm-agentâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 v1 â†’ v3 çš„å…³é”®æ”¹è¿›

| v1 é—®é¢˜ | v3 è§£å†³æ–¹æ¡ˆ |
|---------|------------|
| SSHç›´è¿æ‰§è¡Œå‘½ä»¤ï¼Œä¸å¯é  | æ¯èŠ‚ç‚¹è£…è½»é‡ agent (shellè„šæœ¬) |
| å¤‡ä»½å­˜æœ¬åœ°ï¼Œæ˜“ä¸¢å¤± | Git + GitHubï¼Œç‰ˆæœ¬åŒ–ç®¡ç† |
| æ™ºåŠ›æµ‹è¯•æ–¹æ¡ˆæ¨¡ç³Š | å…·ä½“è¯„åˆ†ç»´åº¦ + åŸºå‡†æµ‹è¯•é›† |
| æ— æƒé™ç®¡ç† | SSH key + API token è®¤è¯ |
| å•ç‚¹ç›‘æ§ | agent ä¸»åŠ¨ä¸ŠæŠ¥ + server è½®è¯¢åŒæ¨¡å¼ |

---

## 3. GitHub å¤‡ä»½æ¶æ„ (æ ¸å¿ƒåˆ›æ–°)

### 3.1 ä»“åº“ç»“æ„

```
ocm-backups (Private GitHub Repo)
â”œâ”€â”€ README.md
â”œâ”€â”€ nodes/
â”‚   â”œâ”€â”€ g3s-01/              â† æ¯èŠ‚ç‚¹ä¸€ä¸ªç›®å½•
â”‚   â”‚   â”œâ”€â”€ config/          â† ~/.openclaw/ é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ config.yaml
â”‚   â”‚   â”‚   â””â”€â”€ gateway.json
â”‚   â”‚   â”œâ”€â”€ workspace/       â† workspace æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SOUL.md
â”‚   â”‚   â”‚   â”œâ”€â”€ MEMORY.md
â”‚   â”‚   â”‚   â”œâ”€â”€ USER.md
â”‚   â”‚   â”‚   â”œâ”€â”€ AGENTS.md
â”‚   â”‚   â”‚   â”œâ”€â”€ TOOLS.md
â”‚   â”‚   â”‚   â””â”€â”€ memory/
â”‚   â”‚   â”‚       â”œâ”€â”€ 2026-02-15.md
â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ cron-export.json â† cron jobs å¯¼å‡º
â”‚   â”‚   â””â”€â”€ metadata.json    â† èŠ‚ç‚¹ä¿¡æ¯å¿«ç…§
â”‚   â”œâ”€â”€ g3s-02/
â”‚   â”œâ”€â”€ ...
â”‚   â””â”€â”€ macmini-01/
â””â”€â”€ .ocm/
    â”œâ”€â”€ scores.json          â† æ™ºåŠ›è¯„åˆ†å†å²
    â””â”€â”€ changelog.md         â† å˜æ›´æ—¥å¿—
```

### 3.2 Git åˆ†æ”¯ç­–ç•¥

```
main                    â† æœ€æ–°ç¨³å®šå¤‡ä»½ (æ™ºåŠ›æµ‹è¯•é€šè¿‡)
â”œâ”€â”€ stable/g3s-01       â† æ¯èŠ‚ç‚¹æœ€åä¸€ä¸ªç¨³å®šç‰ˆ
â”œâ”€â”€ stable/g3s-02
â”œâ”€â”€ ...
â””â”€â”€ snapshots/          â† æ¯æ¬¡å¤‡ä»½çš„å¿«ç…§åˆ†æ”¯ (è‡ªåŠ¨æ¸…ç†30å¤©å‰)
    â”œâ”€â”€ g3s-01/2026-02-15T08-00
    â””â”€â”€ g3s-02/2026-02-15T08-00
```

### 3.3 Tag ç­–ç•¥

```
æ ¼å¼: {node}/{type}/{timestamp}
ç¤ºä¾‹:
  g3s-01/stable/2026-02-15        â† æ™ºåŠ›æµ‹è¯•é€šè¿‡çš„ç¨³å®šç‚¹
  g3s-01/manual/2026-02-15-pre-update  â† æ‰‹åŠ¨æ ‡è®°
  g3s-01/rollback/2026-02-15      â† å›æ»šæ“ä½œè®°å½•
  all/deploy/v1.8.2               â† å…¨é›†ç¾¤ç»Ÿä¸€éƒ¨ç½²ç‰ˆæœ¬
```

### 3.4 å¤‡ä»½æµç¨‹

```
å®šæ—¶å¤‡ä»½ (æ¯6h) or æ‰‹åŠ¨è§¦å‘
    â”‚
    â–¼
1. SSH â†’ èŠ‚ç‚¹: æ‰“åŒ… config + workspace + cron
    â”‚
    â–¼
2. ä¸‹è½½åˆ° OCM Server ä¸´æ—¶ç›®å½•
    â”‚
    â–¼
3. è§£åŒ…åˆ° Git repo å¯¹åº” nodes/{name}/ ç›®å½•
    â”‚
    â–¼
4. git add + git commit (è‡ªåŠ¨ç”Ÿæˆ commit message)
   commit msg: "[g3s-01] auto backup 2026-02-15T08:00 | score:92"
    â”‚
    â–¼
5. æ™ºåŠ›æµ‹è¯•é€šè¿‡?
   â”œâ”€ YES â†’ git tag {node}/stable/{date}
   â”‚        git push origin main --tags
   â”‚        æ›´æ–° stable/{node} åˆ†æ”¯
   â””â”€ NO  â†’ ä»… push åˆ° main (ä¸æ‰“ stable tag)
             è§¦å‘å‘Šè­¦
```

### 3.5 è¿˜åŸæµç¨‹

```
é€‰æ‹©èŠ‚ç‚¹ + é€‰æ‹©è¿˜åŸç‚¹ (tag/commit)
    â”‚
    â–¼
1. è‡ªåŠ¨åˆ›å»ºå½“å‰çŠ¶æ€å¿«ç…§ (pre-rollback tag)
    â”‚
    â–¼
2. git checkout {target-tag} -- nodes/{name}/
    â”‚
    â–¼
3. SSH â†’ èŠ‚ç‚¹: åœæ­¢ OpenClaw
    â”‚
    â–¼
4. SCP ä¸Šä¼ è¿˜åŸæ–‡ä»¶
    â”‚
    â–¼
5. SSH â†’ èŠ‚ç‚¹: é‡å¯ OpenClaw
    â”‚
    â–¼
6. ç­‰å¾…30ç§’ â†’ éªŒè¯èŠ‚ç‚¹çŠ¶æ€
    â”‚
    â–¼
7. git tag {node}/rollback/{date}
   è®°å½•è¿˜åŸæ“ä½œ
```

---

## 4. æ™ºåŠ›ç›‘æ§ç³»ç»Ÿ (è¯¦ç»†è®¾è®¡)

### 4.1 è¯„ä¼°ç»´åº¦ (5ç»´åº¦ Ã— 20åˆ† = 100åˆ†)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ™ºåŠ›è¯„åˆ†é›·è¾¾å›¾                    â”‚
â”‚                                             â”‚
â”‚              è®°å¿†ä¸€è‡´æ€§(20)                   â”‚
â”‚                  â•±â•²                          â”‚
â”‚                â•±    â•²                        â”‚
â”‚   å·¥å…·ä½¿ç”¨(20)â•±      â•² é€»è¾‘æ¨ç†(20)          â”‚
â”‚              â•²      â•±                        â”‚
â”‚                â•²  â•±                          â”‚
â”‚   å›å¤è´¨é‡(20)â”€â”€â•³â”€â”€ äººæ ¼ä¸€è‡´æ€§(20)           â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å„ç»´åº¦æµ‹è¯•æ–¹æ³•

**â‘  è®°å¿†ä¸€è‡´æ€§ (20åˆ†)**
- å†™å…¥æµ‹è¯•æ•°æ®åˆ° memory â†’ ç­‰å¾… â†’ è¯¢é—®æ˜¯å¦è®°å¾—
- æ£€æŸ¥ MEMORY.md ä¸å®é™…å›ç­”çš„ä¸€è‡´æ€§
- æ£€æŸ¥è·¨ session è®°å¿†ä¼ é€’

**â‘¡ é€»è¾‘æ¨ç† (20åˆ†)**
- 5é“æ ‡å‡†åŒ–é¢˜ç›® (æ•°å­¦ã€é€»è¾‘ã€å› æœæ¨ç†)
- é¢˜åº“è½®æ¢ï¼Œé˜²æ­¢"èƒŒç­”æ¡ˆ"
- å¯¹æ¯”æ ‡å‡†ç­”æ¡ˆè¯„åˆ†

**â‘¢ å·¥å…·ä½¿ç”¨ (20åˆ†)**
- è¦æ±‚æ‰§è¡Œæ–‡ä»¶æ“ä½œ â†’ éªŒè¯ç»“æœ
- è¦æ±‚æœç´¢ä¿¡æ¯ â†’ éªŒè¯å‡†ç¡®æ€§
- è¦æ±‚è®¾ç½® cron â†’ éªŒè¯æ˜¯å¦åˆ›å»ºæˆåŠŸ

**â‘£ å›å¤è´¨é‡ (20åˆ†)**
- å‘é€æ ‡å‡†é—®é¢˜ â†’ è¯„ä¼°å›å¤çš„:
  - ç›¸å…³æ€§ (æ˜¯å¦è·‘é¢˜)
  - å®Œæ•´æ€§ (æ˜¯å¦é—æ¼å…³é”®ä¿¡æ¯)
  - ç®€æ´æ€§ (æ˜¯å¦å•°å—¦)
- ç”¨ LLM-as-Judge æ–¹å¼è¯„åˆ†

**â‘¤ äººæ ¼ä¸€è‡´æ€§ (20åˆ†)**
- è¯»å– SOUL.md å®šä¹‰çš„äººæ ¼ç‰¹å¾
- å‘é€æµ‹è¯•å¯¹è¯ â†’ æ£€æŸ¥æ˜¯å¦ç¬¦åˆäººæ ¼
- æ£€æŸ¥è¯­è¨€é£æ ¼ã€ç§°å‘¼ã€æ€åº¦

### 4.3 è¯„åˆ†ç­‰çº§ & è‡ªåŠ¨æ“ä½œ

| åˆ†æ•° | ç­‰çº§ | æ“ä½œ |
|------|------|------|
| 90-100 | ğŸŸ¢ ä¼˜ç§€ | æ ‡è®° stable tag |
| 70-89 | ğŸŸ¡ æ­£å¸¸ | ç»§ç»­è§‚å¯Ÿ |
| 50-69 | ğŸŸ  è­¦å‘Š | Telegram å‘Šè­¦ï¼Œå»ºè®®å›æ»š |
| 0-49 | ğŸ”´ å±é™© | **è‡ªåŠ¨å›æ»š**åˆ°æœ€è¿‘ stable tag |

### 4.4 æ™ºåŠ›ä¸‹é™å¸¸è§åŸå›  & å¯¹ç­–

| åŸå›  | æ£€æµ‹æ–¹æ³• | å¯¹ç­– |
|------|---------|------|
| workspace æ–‡ä»¶æŸå | diffæ£€æŸ¥ | ä» Git è¿˜åŸ |
| MEMORY.md è†¨èƒ€/æ··ä¹± | æ–‡ä»¶å¤§å°+å†…å®¹æ£€æŸ¥ | å›æ»šåˆ°ç¨³å®šç‰ˆ |
| config è¢«æ„å¤–ä¿®æ”¹ | config diff | è¿˜åŸ config |
| OpenClaw ç‰ˆæœ¬ bug | ç‰ˆæœ¬å·+è¯„åˆ†å…³è” | å›é€€ç‰ˆæœ¬ |
| API æ¨¡å‹å˜æ›´ | æ¨¡å‹åæ£€æŸ¥ | å‘Šè­¦é€šçŸ¥ |

---

## 5. èŠ‚ç‚¹ Agent è®¾è®¡

æ¯ä¸ªèŠ‚ç‚¹å®‰è£…ä¸€ä¸ªè½»é‡ shell agentï¼Œå‡å°‘ SSH ç›´è¿å¤æ‚åº¦ã€‚

### 5.1 ocm-agent (Bash è„šæœ¬)

```bash
# /opt/ocm-agent/agent.sh
# åŠŸèƒ½:
# - æ”¶é›†ç³»ç»ŸçŠ¶æ€ (CPU/RAM/Disk/Uptime)
# - æ”¶é›† OpenClaw çŠ¶æ€ (ç‰ˆæœ¬/è¿è¡ŒçŠ¶æ€/sessionæ•°)
# - æ‰“åŒ…å¤‡ä»½æ–‡ä»¶
# - æ‰§è¡Œè¿˜åŸæ“ä½œ
# - å“åº”å¥åº·æ£€æŸ¥
```

### 5.2 Agent API (é€šè¿‡ SSH è°ƒç”¨)

```
ssh node "ocm-agent status"      â†’ JSON çŠ¶æ€
ssh node "ocm-agent backup"      â†’ æ‰“åŒ…å¹¶è¾“å‡ºè·¯å¾„
ssh node "ocm-agent restore /path/to/backup.tar.gz"
ssh node "ocm-agent health"      â†’ OK/ERROR
ssh node "ocm-agent openclaw-restart"
ssh node "ocm-agent openclaw-version"
ssh node "ocm-agent openclaw-config"  â†’ è¾“å‡ºé…ç½®
```

---

## 6. æ•°æ®åº“è®¾è®¡

### 6.1 nodes è¡¨
```sql
CREATE TABLE nodes (
  id TEXT PRIMARY KEY,           -- 'g3s-01'
  name TEXT NOT NULL,            -- 'ä¹¦æˆ¿G3S-1å·'
  host TEXT NOT NULL,            -- '192.168.20.101'
  port INTEGER DEFAULT 22,
  ssh_user TEXT DEFAULT 'ocm',
  ssh_key_path TEXT,
  openclaw_path TEXT,            -- '/home/ocm/.openclaw'
  status TEXT DEFAULT 'unknown', -- online/offline/error
  last_seen_at INTEGER,
  last_backup_at INTEGER,
  last_score INTEGER,
  last_score_at INTEGER,
  tags TEXT,                     -- JSON array
  created_at INTEGER,
  updated_at INTEGER
);
```

### 6.2 backups è¡¨
```sql
CREATE TABLE backups (
  id INTEGER PRIMARY KEY,
  node_id TEXT NOT NULL,
  git_commit TEXT,              -- commit SHA
  git_tag TEXT,                 -- tag name (if stable)
  type TEXT,                    -- auto/manual/pre-rollback
  score INTEGER,               -- æ™ºåŠ›è¯„åˆ† (null if not tested)
  is_stable BOOLEAN DEFAULT 0,
  file_count INTEGER,
  total_size INTEGER,           -- bytes
  note TEXT,
  created_at INTEGER,
  FOREIGN KEY (node_id) REFERENCES nodes(id)
);
```

### 6.3 scores è¡¨
```sql
CREATE TABLE scores (
  id INTEGER PRIMARY KEY,
  node_id TEXT NOT NULL,
  total_score INTEGER,
  memory_score INTEGER,         -- è®°å¿†ä¸€è‡´æ€§
  logic_score INTEGER,          -- é€»è¾‘æ¨ç†
  tool_score INTEGER,           -- å·¥å…·ä½¿ç”¨
  quality_score INTEGER,        -- å›å¤è´¨é‡
  personality_score INTEGER,    -- äººæ ¼ä¸€è‡´æ€§
  details TEXT,                 -- JSON: è¯¦ç»†æµ‹è¯•ç»“æœ
  action_taken TEXT,            -- none/alert/rollback
  backup_id INTEGER,            -- å…³è”çš„å¤‡ä»½
  created_at INTEGER,
  FOREIGN KEY (node_id) REFERENCES nodes(id)
);
```

### 6.4 events è¡¨ (æ“ä½œæ—¥å¿—)
```sql
CREATE TABLE events (
  id INTEGER PRIMARY KEY,
  node_id TEXT,                 -- null = å…¨å±€äº‹ä»¶
  type TEXT,                    -- install/backup/restore/score/alert/config
  severity TEXT,                -- info/warn/error/critical
  message TEXT,
  details TEXT,                 -- JSON
  created_at INTEGER
);
```

---

## 7. API è®¾è®¡

### 7.1 èŠ‚ç‚¹ç®¡ç†
```
GET    /api/nodes                  â† æ‰€æœ‰èŠ‚ç‚¹åˆ—è¡¨+çŠ¶æ€
POST   /api/nodes                  â† æ³¨å†Œæ–°èŠ‚ç‚¹
GET    /api/nodes/:id              â† èŠ‚ç‚¹è¯¦æƒ…
PUT    /api/nodes/:id              â† æ›´æ–°èŠ‚ç‚¹ä¿¡æ¯
DELETE /api/nodes/:id              â† åˆ é™¤èŠ‚ç‚¹
POST   /api/nodes/:id/test-ssh     â† æµ‹è¯• SSH è¿æ¥
POST   /api/nodes/:id/install      â† ä¸€é”®å®‰è£… OpenClaw
```

### 7.2 å¤‡ä»½/è¿˜åŸ
```
GET    /api/nodes/:id/backups      â† å¤‡ä»½åˆ—è¡¨ (å« git tag/commit)
POST   /api/nodes/:id/backups      â† è§¦å‘å¤‡ä»½
POST   /api/nodes/:id/restore      â† è¿˜åŸåˆ°æŒ‡å®šç‰ˆæœ¬
GET    /api/nodes/:id/backups/:bid/diff  â† ä¸å½“å‰ç‰ˆæœ¬ diff
POST   /api/backups/all            â† å…¨é›†ç¾¤å¤‡ä»½
```

### 7.3 æ™ºåŠ›è¯„ä¼°
```
GET    /api/nodes/:id/scores       â† è¯„åˆ†å†å²
POST   /api/nodes/:id/scores       â† è§¦å‘æ™ºåŠ›æµ‹è¯•
GET    /api/scores/overview        â† å…¨é›†ç¾¤è¯„åˆ†æ¦‚è§ˆ
PUT    /api/scores/config          â† è°ƒæ•´é˜ˆå€¼/é¢‘ç‡
```

### 7.4 ç›‘æ§
```
GET    /api/dashboard              â† Dashboard å…¨é‡æ•°æ®
GET    /api/nodes/:id/metrics      â† èŠ‚ç‚¹å®æ—¶æŒ‡æ ‡
GET    /api/events                 â† äº‹ä»¶/æ—¥å¿—åˆ—è¡¨
GET    /api/costs                  â† API è´¹ç”¨ç»Ÿè®¡
```

### 7.5 é›†ç¾¤æ“ä½œ
```
POST   /api/cluster/deploy         â† å…¨é›†ç¾¤éƒ¨ç½²/å‡çº§
POST   /api/cluster/sync-config    â† åŒæ­¥é…ç½®åˆ°æ‰€æœ‰èŠ‚ç‚¹
GET    /api/cluster/topology       â† ç½‘ç»œæ‹“æ‰‘
```

---

## 8. å‰ç«¯é¡µé¢è®¾è®¡

### 8.1 é¡µé¢ç»“æ„

```
/ (Dashboard)
â”œâ”€â”€ /nodes                    â† èŠ‚ç‚¹åˆ—è¡¨
â”‚   â”œâ”€â”€ /nodes/:id            â† èŠ‚ç‚¹è¯¦æƒ…
â”‚   â”œâ”€â”€ /nodes/:id/backups    â† å¤‡ä»½å†å²
â”‚   â”œâ”€â”€ /nodes/:id/scores     â† æ™ºåŠ›è¯„åˆ†å›¾è¡¨
â”‚   â””â”€â”€ /nodes/:id/terminal   â† Web SSH
â”œâ”€â”€ /backups                  â† å…¨å±€å¤‡ä»½ç®¡ç†
â”œâ”€â”€ /scores                   â† æ™ºåŠ›è¯„åˆ†æ€»è§ˆ
â”œâ”€â”€ /deploy                   â† éƒ¨ç½²ç®¡ç†
â”œâ”€â”€ /costs                    â† è´¹ç”¨è¿½è¸ª
â”œâ”€â”€ /events                   â† äº‹ä»¶æ—¥å¿—
â””â”€â”€ /settings                 â† è®¾ç½® (GitHub/å‘Šè­¦/é˜ˆå€¼)
```

### 8.2 Dashboard å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCM Dashboard                         [å…¨é›†ç¾¤å¤‡ä»½] [âš™]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ â”Œâ”€æ¦‚è§ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸŸ¢ åœ¨çº¿: 6/7   ğŸ“¦ ä»Šæ—¥å¤‡ä»½: 14   ğŸ§  å¹³å‡æ™ºåŠ›: 88 â”‚â”‚
â”‚ â”‚ ğŸ’° æœ¬æœˆè´¹ç”¨: $145   âš ï¸ å‘Šè­¦: 1                    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€èŠ‚ç‚¹ç½‘æ ¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚ â”‚ â”‚ğŸŸ¢G3S-01 â”‚ â”‚ğŸŸ¢G3S-02 â”‚ â”‚ğŸŸ¢G3S-03 â”‚ â”‚ğŸŸ¡G3S-04 â”‚  â”‚â”‚
â”‚ â”‚ â”‚CPU: 8%  â”‚ â”‚CPU: 12% â”‚ â”‚CPU: 5%  â”‚ â”‚CPU: 45% â”‚  â”‚â”‚
â”‚ â”‚ â”‚RAM: 42% â”‚ â”‚RAM: 38% â”‚ â”‚RAM: 51% â”‚ â”‚RAM: 67% â”‚  â”‚â”‚
â”‚ â”‚ â”‚ğŸ§  95    â”‚ â”‚ğŸ§  88    â”‚ â”‚ğŸ§  91    â”‚ â”‚ğŸ§  72 âš ï¸ â”‚  â”‚â”‚
â”‚ â”‚ â”‚v1.8.2   â”‚ â”‚v1.8.2   â”‚ â”‚v1.8.2   â”‚ â”‚v1.8.1   â”‚  â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚ â”‚ â”‚ğŸŸ¢G3S-05 â”‚ â”‚ğŸŸ¢Mini-01 â”‚ â”‚ğŸ”´Mini-02 â”‚            â”‚â”‚
â”‚ â”‚ â”‚CPU: 10% â”‚ â”‚CPU: 22%  â”‚ â”‚ OFFLINE  â”‚            â”‚â”‚
â”‚ â”‚ â”‚RAM: 40% â”‚ â”‚RAM: 55%  â”‚ â”‚          â”‚            â”‚â”‚
â”‚ â”‚ â”‚ğŸ§  89    â”‚ â”‚ğŸ§  93     â”‚ â”‚ğŸ§  --     â”‚            â”‚â”‚
â”‚ â”‚ â”‚v1.8.2   â”‚ â”‚v1.8.2    â”‚ â”‚v1.8.2    â”‚            â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€æ™ºåŠ›è¶‹åŠ¿å›¾â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€æœ€è¿‘äº‹ä»¶â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚  100â”‚    â•­â”€â”€â•®                â”‚ â”‚ 08:00 G3S-01 å‚™ä»½â”‚|
â”‚ â”‚   80â”‚â•­â”€â”€â”€â•¯  â•°â”€â”€â•®  â†G3S-01  â”‚ â”‚ 07:55 G3S-04 âš ï¸ â”‚|
â”‚ â”‚   60â”‚           â•°â”€ â†G3S-04  â”‚ â”‚ 07:30 å…¨é›†ç¾¤å‚™ä»½  â”‚|
â”‚ â”‚   40â”‚                       â”‚ â”‚ 06:00 æ™ºåŠ›ãƒ†ã‚¹ãƒˆ  â”‚|
â”‚ â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚ 05:00 Mini-02 æ–­ç·šâ”‚|
â”‚ â”‚      2/10  2/11  2/12  2/13 â”‚ â”‚                   â”‚|
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. å®‰å…¨è®¾è®¡

### 9.1 SSH å®‰å…¨
- æ‰€æœ‰èŠ‚ç‚¹ä½¿ç”¨ SSH key è®¤è¯ï¼ˆç¦ç”¨å¯†ç ï¼‰
- OCM ä¸“ç”¨ç”¨æˆ· `ocm`ï¼Œé™åˆ¶ sudo æƒé™
- SSH key å­˜å‚¨åœ¨ OCM Serverï¼Œä¸ä¸Šä¼  GitHub

### 9.2 GitHub å®‰å…¨
- Private repo
- Deploy key (åªæ¨ä¸æ‹‰ or è¯»å†™)
- æ•æ„Ÿä¿¡æ¯è¿‡æ»¤ï¼šAPI keyã€tokenã€å¯†ç ä¸å…¥ Git
  - `.gitignore` + é¢„æäº¤æ£€æŸ¥ (grep pattern)
- å¤‡ä»½å‰è‡ªåŠ¨è„±æ•: config.yaml ä¸­çš„ token â†’ `***REDACTED***`

### 9.3 OCM è‡ªèº«å®‰å…¨
- Web Dashboard åŠ å¯†ç ä¿æŠ¤ (bcrypt)
- API token è®¤è¯
- å†…ç½‘è®¿é—® only (ä¸æš´éœ²åˆ°å…¬ç½‘)

### 9.4 æ•æ„Ÿä¿¡æ¯å¤„ç†

```
å¤‡ä»½æ—¶è„±æ•çš„å­—æ®µ:
â”œâ”€â”€ config.yaml
â”‚   â”œâ”€â”€ anthropic.apiKey â†’ "***REDACTED***"
â”‚   â”œâ”€â”€ telegram.botToken â†’ "***REDACTED***"
â”‚   â””â”€â”€ openai.apiKey â†’ "***REDACTED***"
â”œâ”€â”€ gateway.json
â”‚   â””â”€â”€ token â†’ "***REDACTED***"
â””â”€â”€ ç¯å¢ƒå˜é‡ä¸­çš„ KEY/TOKEN/SECRET

è¿˜åŸæ—¶:
â”œâ”€â”€ æ£€æµ‹åˆ° REDACTED å­—æ®µ â†’ ä¿ç•™ç›®æ ‡èŠ‚ç‚¹å½“å‰å€¼
â””â”€â”€ ä¸è¦†ç›–æ•æ„Ÿä¿¡æ¯
```

---

## 10. åˆå§‹åŒ–å®‰è£…æµç¨‹ (è¯¦ç»†)

### 10.1 æ–°èŠ‚ç‚¹åŠ å…¥æµç¨‹

```
ç”¨æˆ·åœ¨ OCM æ·»åŠ èŠ‚ç‚¹ (IP + åˆå§‹å¯†ç )
    â”‚
    â–¼
1. SSH è¿æ¥æµ‹è¯•
    â”‚
    â–¼
2. åˆ›å»º ocm ç”¨æˆ· + SSH key éƒ¨ç½²
    â”‚
    â–¼
3. å®‰è£…ä¾èµ–:
   â”œâ”€â”€ Node.js (via nvm)
   â”œâ”€â”€ git
   â”œâ”€â”€ åŸºç¡€å·¥å…· (curl, tar, jq)
   â””â”€â”€ ocm-agent è„šæœ¬
    â”‚
    â–¼
4. å®‰è£… OpenClaw:
   â”œâ”€â”€ npm install -g openclaw
   â”œâ”€â”€ openclaw init (äº¤äº’å¼ or æ¨¡æ¿)
   â””â”€â”€ ä»æ¨¡æ¿/å…¶ä»–èŠ‚ç‚¹å¤åˆ¶é…ç½®
    â”‚
    â–¼
5. é…ç½® OpenClaw:
   â”œâ”€â”€ Telegram Bot Token
   â”œâ”€â”€ API Key (Anthropic/OpenAI)
   â”œâ”€â”€ æ¨¡å‹è®¾ç½®
   â””â”€â”€ workspace åˆå§‹åŒ– (SOUL.md ç­‰)
    â”‚
    â–¼
6. å¯åŠ¨ OpenClaw + è®¾ä¸ºè‡ªå¯åŠ¨ (systemd)
    â”‚
    â–¼
7. é¦–æ¬¡å¤‡ä»½ + æ™ºåŠ›åŸºå‡†æµ‹è¯•
    â”‚
    â–¼
8. æ ‡è®°ä¸º onlineï¼ŒåŠ å…¥å®šæœŸç›‘æ§
```

### 10.2 é…ç½®æ¨¡æ¿

```yaml
# ocm-templates/default.yaml
openclaw:
  model: anthropic/claude-sonnet-4-20250514
  workspace:
    copy_from: "macmini-01"  # ä»å“ªå°å¤åˆ¶ SOUL/AGENTS
    customize:
      - IDENTITY.md           # æ¯å°ç‹¬ç«‹
      - MEMORY.md             # æ¯å°ç‹¬ç«‹
  telegram:
    # token åœ¨ OCM ç•Œé¢å•ç‹¬é…ç½®
  heartbeat:
    enabled: true
    interval: 30m
```

---

## 11. è´¹ç”¨è¿½è¸ª

### 11.1 æ•°æ®æ¥æº
- OpenClaw session_status API â†’ æ¯ä¸ª session çš„ token ä½¿ç”¨é‡
- æŒ‰æ¨¡å‹ä»·æ ¼è®¡ç®—è´¹ç”¨
- æ¯æ—¥æ±‡æ€» + æ¯æœˆæ±‡æ€»

### 11.2 è´¹ç”¨æ•°æ®è¡¨
```sql
CREATE TABLE costs (
  id INTEGER PRIMARY KEY,
  node_id TEXT NOT NULL,
  date TEXT NOT NULL,           -- ' 2026-02-15'
  model TEXT,
  input_tokens INTEGER,
  output_tokens INTEGER,
  cost_usd REAL,
  sessions_count INTEGER,
  created_at INTEGER
);
```

---

## 12. å‘Šè­¦é€šçŸ¥

### 12.1 å‘Šè­¦è§„åˆ™

| äº‹ä»¶ | çº§åˆ« | é€šçŸ¥æ–¹å¼ |
|------|------|---------|
| èŠ‚ç‚¹ç¦»çº¿ >5min | ğŸ”´ critical | Telegram å³æ—¶ |
| æ™ºåŠ›è¯„åˆ† <70 | ğŸŸ  warning | Telegram å³æ—¶ |
| æ™ºåŠ›è¯„åˆ† <50 + è‡ªåŠ¨å›æ»š | ğŸ”´ critical | Telegram å³æ—¶ |
| å¤‡ä»½å¤±è´¥ | ğŸŸ  warning | Telegram |
| ç£ç›˜ä½¿ç”¨ >80% | ğŸŸ¡ info | Dashboard |
| OpenClaw è¿›ç¨‹å´©æºƒ | ğŸ”´ critical | Telegram å³æ—¶ |
| API æ—¥è´¹ç”¨ >$10 | ğŸŸ¡ info | Telegram |
| æ–°ç‰ˆæœ¬å¯ç”¨ | ğŸŸ¢ info | Dashboard |

### 12.2 Telegram é€šçŸ¥æ ¼å¼

```
âš ï¸ [OCM å‘Šè­¦] G3S-04 æ™ºåŠ›ä¸‹é™

è¯„åˆ†: 45/100 (ä¹‹å‰: 88/100)
â”œâ”€ è®°å¿†ä¸€è‡´æ€§: 5/20 âš ï¸
â”œâ”€ é€»è¾‘æ¨ç†: 12/20
â”œâ”€ å·¥å…·ä½¿ç”¨: 8/20 âš ï¸
â”œâ”€ å›å¤è´¨é‡: 10/20
â””â”€ äººæ ¼ä¸€è‡´æ€§: 10/20

æ“ä½œ: ğŸ”„ å·²è‡ªåŠ¨å›æ»šåˆ° g3s-04/stable/2026-02-14
çŠ¶æ€: âœ… å›æ»šæˆåŠŸï¼Œç­‰å¾…é‡æ–°è¯„ä¼°...

[æŸ¥çœ‹è¯¦æƒ…] [æ‰‹åŠ¨å›æ»š] [å¿½ç•¥]
```

---

## 13. OCM è‡ªèº«å¤‡ä»½

OCM Server æœ¬èº«ä¹Ÿæ˜¯å…³é”®æ•°æ®ï¼Œéœ€è¦çº³å…¥å¤‡ä»½ã€‚

### 13.1 OCM å¤‡ä»½å†…å®¹

```
ocm-backups repo è¿½åŠ :
â”œâ”€â”€ nodes/          â† (æ—¢å­˜) å„èŠ‚ç‚¹å¤‡ä»½
â””â”€â”€ ocm-master/     â† ğŸ†• OCMè‡ªèº«
    â”œâ”€â”€ db/
    â”‚   â””â”€â”€ ocm.db              â† SQLite æ•°æ®åº“
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ ocm-config.json     â† OCM è®¾ç½®
    â”œâ”€â”€ templates/
    â”‚   â””â”€â”€ *.yaml              â† é…ç½®æ¨¡æ¿
    â””â”€â”€ test-suite/
        â””â”€â”€ test-suite.json     â† æ™ºåŠ›æµ‹è¯•é¢˜åº“
```

### 13.2 åŒå¤‡ä»½æ¶æ„: GitHub + Google Drive

```
å®šæ—¶å¤‡ä»½ (æ¯6h)
    â”‚
    â”œâ”€â”€â†’ GitHub (Private Repo)     â† ç‰ˆæœ¬ç®¡ç†ã€diffã€è¿˜åŸ
    â”‚    â”œâ”€â”€ git commit + push
    â”‚    â””â”€â”€ æ°¸ä¹…ä¿ç•™ (main + tags)
    â”‚
    â””â”€â”€â†’ Google Drive              â† ç¾éš¾æ¢å¤ã€å†—ä½™
         â”œâ”€â”€ å‹ç¼©åŒ…: ocm-backup-{date}.tar.gz
         â”œâ”€â”€ æ¯æ—¥ä¸€ä»½å®Œæ•´å¤‡ä»½
         â””â”€â”€ ä¿ç•™æœŸé™: 30å¤© (è‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶)
```

### 13.3 Google Drive é›†æˆ

**æ–¹å¼:** Google Drive API + Service Account

**ç›®å½•ç»“æ„:**
```
Google Drive
â””â”€â”€ OCM-Backups/
    â”œâ”€â”€ daily/
    â”‚   â”œâ”€â”€ 2026-02-15_ocm-full.tar.gz    (å«å…¨éƒ¨èŠ‚ç‚¹+OCM)
    â”‚   â”œâ”€â”€ 2026-02-14_ocm-full.tar.gz
    â”‚   â””â”€â”€ ... (30å¤©åˆ†)
    â””â”€â”€ stable/
        â”œâ”€â”€ g3s-01_stable_2026-02-15.tar.gz  (æ™ºåŠ›æµ‹è¯•é€šè¿‡çš„)
        â””â”€â”€ ...
```

**ä¿ç•™ç­–ç•¥:**
| ç±»å‹ | ä¿ç•™æœŸé™ | è¯´æ˜ |
|------|---------|------|
| daily å®Œæ•´å¤‡ä»½ | 30å¤© | è‡ªåŠ¨åˆ é™¤è¶…è¿‡30å¤©çš„ |
| stable ç¨³å®šå¤‡ä»½ | 90å¤© | æ™ºåŠ›æµ‹è¯•é€šè¿‡çš„ä¿ç•™æ›´ä¹… |
| manual æ‰‹åŠ¨å¤‡ä»½ | æ°¸ä¹… | ç”¨æˆ·æ‰‹åŠ¨è§¦å‘çš„ä¸è‡ªåŠ¨åˆ é™¤ |

### 13.4 å¤‡ä»½æµç¨‹ (æ›´æ–°ç‰ˆ)

```
å®šæ—¶è§¦å‘ or æ‰‹åŠ¨è§¦å‘
    â”‚
    â–¼
1. å„èŠ‚ç‚¹: SSH â†’ æ‰“åŒ… config + workspace + cron
    â”‚
    â–¼
2. OCMè‡ªèº«: å¯¼å‡º SQLite DB + config + templates
    â”‚
    â–¼
3. å…¨éƒ¨å†™å…¥ Git repo (nodes/ + ocm-master/)
    â”‚
    â–¼
4. git commit + push â†’ GitHub âœ…
    â”‚
    â–¼
5. æ‰“åŒ…æ•´ä¸ªå¤‡ä»½ç›®å½• â†’ tar.gz
    â”‚
    â–¼
6. ä¸Šä¼ åˆ° Google Drive (daily/) âœ…
    â”‚
    â–¼
7. æ¸…ç† Google Drive è¶…è¿‡30å¤©çš„ daily æ–‡ä»¶
    â”‚
    â–¼
8. è®°å½•äº‹ä»¶æ—¥å¿—
```

### 13.5 ç¾éš¾æ¢å¤åœºæ™¯

| åœºæ™¯ | æ¢å¤æ¥æº | æ–¹æ³• |
|------|---------|------|
| å•èŠ‚ç‚¹ workspace æŸå | GitHub | `git checkout tag -- nodes/{name}/` |
| OCM æ•°æ®åº“æŸå | GitHub | `git checkout -- ocm-master/db/` |
| OCM Server ç¡¬ç›˜å | Google Drive | ä¸‹è½½æœ€è¿‘ tar.gz è¿˜åŸ |
| GitHub ä»“åº“ä¸¢å¤± | Google Drive | ä» tar.gz é‡å»º repo |
| å…¨é›†ç¾¤æ–­ç”µæŸå | Google Drive | ä»æœ€è¿‘å¤‡ä»½å…¨é‡è¿˜åŸ |

### 13.6 æŠ€æœ¯å®ç°

```javascript
// Google Drive é›†æˆ
dependencies: {
  "googleapis": "^130.0.0",  // Google Drive API
  "archiver": "^7.0.0",     // å‹ç¼©æ‰“åŒ…
}

// æ¸…ç†é€»è¾‘ (ä¼ªä»£ç )
async function cleanupOldBackups() {
  const files = await drive.listFiles('OCM-Backups/daily/');
  const cutoff = Date.now() - 30 * 24 * 60 * 60 * 1000;
  for (const file of files) {
    if (file.createdTime < cutoff) {
      await drive.deleteFile(file.id);
      log(`Deleted old backup: ${file.name}`);
    }
  }
}
```

---

## 14. ä¸€é”®åˆå§‹åŒ–ç³»ç»Ÿ (è¯¦ç»†è®¾è®¡)

### 14.1 åˆå§‹åŒ–å‘å¯¼ (4æ­¥)

```
OCM Dashboard: [æ·»åŠ æ–°èŠ‚ç‚¹]

Step 1: åŸºæœ¬ä¿¡æ¯
  - èŠ‚ç‚¹åç§° / IP / åˆå§‹ç”¨æˆ·+å¯†ç 
  - è§’è‰²: ç”Ÿäº§ / æµ‹è¯• / å¤‡ç”¨

Step 2: OS è®¾å®š (å…¨éƒ¨å¯é€‰, é»˜è®¤å…¨å‹¾)
  â˜‘ åˆ›å»º ocm ç”¨æˆ· + SSH key
  â˜‘ ç¦ç”¨ root SSH + å¯†ç ç™»å½•
  â˜‘ è®¾ç½® hostname + é™æ€IP + æ—¶åŒº(Asia/Tokyo)
  â˜‘ apt update + å®‰è£…åŸºç¡€å·¥å…·
  â˜‘ é…ç½® UFW é˜²ç«å¢™ (allow 22, 3000)
  â˜‘ å¯ç”¨ unattended-upgrades

Step 3: OpenClaw è®¾å®š
  - Node.js ç‰ˆæœ¬ / OpenClaw ç‰ˆæœ¬
  - é…ç½®æ¨¡æ¿ (default / custom)
  - Workspace æ¥æº: ç©ºç™½ / ä»èŠ‚ç‚¹å¤åˆ¶ / ä»Gitè¿˜åŸ

Step 4: Bot & API
  - Telegram Bot Token
  - Anthropic / OpenAI API Key
  - é»˜è®¤æ¨¡å‹ + Thinking level
  - Owner ID
```

### 14.2 æ‰§è¡Œæµç¨‹ (è‡ªåŠ¨, ~7min)

```
Phase 1: OS åŸºç¡€ (~3min)
  SSHè¿æ¥ â†’ apt update â†’ åˆ›å»ºocmç”¨æˆ· â†’ SSH key â†’ é˜²ç«å¢™ â†’ æ—¶åŒº

Phase 2: è¿è¡Œç¯å¢ƒ (~2min)
  nvm install â†’ npm install -g openclaw â†’ å®‰è£… ocm-agent

Phase 3: OpenClaw é…ç½® (~1min)
  openclaw init â†’ å†™å…¥config â†’ å†™å…¥Token/Key â†’ åˆå§‹åŒ–workspace â†’ systemdè‡ªå¯åŠ¨

Phase 4: éªŒè¯ (~1min)
  å¯åŠ¨OpenClaw â†’ æ£€æŸ¥è¿›ç¨‹ â†’ æ£€æŸ¥Botå“åº” â†’ é¦–æ¬¡å¤‡ä»½ â†’ é¦–æ¬¡æ™ºåŠ›åŸºå‡†æµ‹è¯•
```

### 14.3 å®æ—¶è¿›åº¦æ˜¾ç¤º

Web UI æ˜¾ç¤ºæ¯ä¸ªæ­¥éª¤çš„ âœ…â³â¬œ çŠ¶æ€ + å®æ—¶æ—¥å¿— + è¿›åº¦æ¡ã€‚
å¤±è´¥æ—¶å¯æŸ¥çœ‹é”™è¯¯æ—¥å¿—ã€é‡è¯•å•ä¸ªæ­¥éª¤ã€‚

---

## 15. Bot ç®¡ç†é¢æ¿

### 15.1 æ¯èŠ‚ç‚¹ Bot/æ¨¡å‹ç®¡ç†

- **Telegram Bot:** Token æŸ¥çœ‹/å˜æ›´ï¼Œè¿æ¥çŠ¶æ€ï¼ŒOwner è®¾å®š
- **æ¨¡å‹è®¾å®š:**
  - é»˜è®¤æ¨¡å‹ + Thinking level
  - Session åˆ«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ (main=opus, group=sonnet, cron=haiku)
- **API Keys:** Anthropic/OpenAI/Googleï¼Œæµ‹è¯•è¿æ¥ï¼ŒKey è½®æ¢
- **å¿«æ·æ“ä½œ:** é‡å¯ / æš‚åœ / æŸ¥çœ‹æ—¥å¿— / ç¼–è¾‘é…ç½®

### 15.2 é›†ç¾¤ä¸€æ‹¬æ“ä½œ

- é€‰æ‹©ç›®æ ‡èŠ‚ç‚¹ (å…¨é€‰ / ä»…ç”Ÿäº§ / ä»…æµ‹è¯•)
- æ“ä½œ: æ¨¡å‹ä¸€æ‹¬å˜æ›´ / API Key æ›´æ–° / é…ç½®åŒæ­¥ / ä¸€æ‹¬é‡å¯ / ä¸€æ‹¬å¤‡ä»½

---

## 16. æµ‹è¯•ç¯å¢ƒ & åˆ†é˜¶æ®µéƒ¨ç½²

### 16.1 ç¯å¢ƒåˆ†ç±»

```
ãƒ†ã‚¹ãƒˆç’°å¢ƒ (1å°: mini-02)    æœ¬ç•ªç’°å¢ƒ (6å°: g3s-01~05, mini-01)
         â”‚                           â–²
         â”‚  æ¤œè¨¼OKãƒ»æ‰‹å‹•æ‰¿èªå¾Œ         â”‚
         â””â”€â”€â”€â”€ ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ â”€â”€â”˜
```

### 16.2 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```
æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ or è¨­å®šå¤‰æ›´
    â”‚
    â–¼
Stage 1: ãƒ†ã‚¹ãƒˆç’°å¢ƒ (mini-02) ã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
    â”œâ”€â”€ åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ (èµ·å‹•/å¿œç­”/ãƒ„ãƒ¼ãƒ«)
    â”œâ”€â”€ æ™ºåŠ›ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    â””â”€â”€ 24h å®‰å®šæ€§ç¢ºèª
    â”‚
    â”œâ”€â”€ âŒ å¤±æ•— â†’ å‘Šè­¦ + è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€æœ¬ç•ªå±•é–‹ã—ãªã„
    â”‚
    â””â”€â”€ âœ… æˆåŠŸ â†’ ãƒ†ã‚¹ãƒˆçµæœãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
                  â”‚
                  â–¼
              [å…¨ãƒãƒ¼ãƒ‰ã«å±•é–‹ ğŸš€] or [å´ä¸‹] (æ‰‹å‹•æ‰¿èª)
                  â”‚
                  â–¼
Stage 2: ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ (1å°ãšã¤)
    â”œâ”€â”€ äº‹å‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (pre-update tag)
    â”œâ”€â”€ OpenClawåœæ­¢ â†’ æ›´æ–° â†’ èµ·å‹•
    â”œâ”€â”€ 30ç§’å¾…æ©Ÿ â†’ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
    â”œâ”€â”€ âœ… OK â†’ æ¬¡ã®ãƒãƒ¼ãƒ‰ã¸
    â””â”€â”€ âŒ NG â†’ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ + æ®‹ã‚Šä¸­æ–­ + å‘Šè­¦
```

### 16.3 ã‚«ãƒŠãƒªã‚¢ãƒ‡ãƒ—ãƒ­ã‚¤ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

- 6å°ä¸­1å°ã ã‘å…ˆã«æ›´æ–° (ã‚«ãƒŠãƒªã‚¢)
- 2æ™‚é–“ç›£è¦– â†’ å•é¡Œãªã— â†’ æ®‹ã‚Š5å°
- å•é¡Œã‚ã‚Š â†’ ã‚«ãƒŠãƒªã‚¢ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€å±•é–‹ä¸­æ­¢

### 16.4 ãƒ†ã‚¹ãƒˆç’°å¢ƒç®¡ç†ç”»é¢

- ç¾åœ¨/æœ¬ç•ª/æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
- ãƒ†ã‚¹ãƒˆå±¥æ­´ (æ—¥æ™‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€çµæœã€ã‚¹ã‚³ã‚¢)
- ãƒ†ã‚¹ãƒˆè¨­å®š: å®‰å®šæ€§ç¢ºèªæ™‚é–“(24h) / æ™ºåŠ›é–¾å€¤(80) / è‡ªå‹•å±•é–‹(æœ‰åŠ¹/ç„¡åŠ¹)

---

## 17. æŠ€æœ¯æ ˆç¡®è®¤ (æ›´æ–°ç‰ˆ)

| å±‚ | æŠ€æœ¯ | ç†ç”± |
|----|------|------|
| å‰ç«¯ | React 18 + Vite + TailwindCSS | ä¸ EOP ä¸€è‡´ï¼Œå¤ç”¨ç»éªŒ |
| å›¾è¡¨ | Recharts | è½»é‡ã€React åŸç”Ÿ |
| åç«¯ | Node.js + Express | ç®€å•å¯é  |
| å®æ—¶ | WebSocket (ws) | çŠ¶æ€å®æ—¶æ¨é€ |
| DB | better-sqlite3 | æ— éœ€é¢å¤–æœåŠ¡ |
| SSH | ssh2 (npm) | çº¯ JSï¼Œæ— éœ€å¤–éƒ¨ä¾èµ– |
| Git | simple-git (npm) | Git æ“ä½œå°è£… |
| å®šæ—¶ | node-cron | è½»é‡è°ƒåº¦ |
| äº‘å­˜å‚¨ | googleapis (npm) | Google Drive API |
| å‹ç¼© | archiver (npm) | tar.gz æ‰“åŒ… |
| éƒ¨ç½² | PM2 or systemd | è¿›ç¨‹ç®¡ç† |
| Webç»ˆç«¯ | xterm.js + node-pty | Web SSH |

---

## 14. ç›®å½•ç»“æ„

```
~/.openclaw/ws-ocm/ocm/
â”œâ”€â”€ package.json
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ index.js              â† Express å…¥å£
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ nodes.js
â”‚   â”‚   â”œâ”€â”€ backups.js
â”‚   â”‚   â”œâ”€â”€ scores.js
â”‚   â”‚   â”œâ”€â”€ dashboard.js
â”‚   â”‚   â”œâ”€â”€ cluster.js
â”‚   â”‚   â””â”€â”€ events.js
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ssh-pool.js       â† SSH è¿æ¥æ± 
â”‚   â”‚   â”œâ”€â”€ git-manager.js    â† Git å¤‡ä»½æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ backup.js         â† å¤‡ä»½é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ restore.js        â† è¿˜åŸé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ scorer.js         â† æ™ºåŠ›è¯„ä¼°
â”‚   â”‚   â”œâ”€â”€ monitor.js        â† çŠ¶æ€ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ alerter.js        â† å‘Šè­¦é€šçŸ¥
â”‚   â”‚   â””â”€â”€ installer.js      â† èŠ‚ç‚¹å®‰è£…
â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â””â”€â”€ ocm-agent.sh      â† èŠ‚ç‚¹ agent è„šæœ¬
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”œâ”€â”€ default.yaml      â† é»˜è®¤é…ç½®æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ test-suite.json   â† æ™ºåŠ›æµ‹è¯•é¢˜åº“
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ schema.sql
â”‚   â”‚   â””â”€â”€ ocm.db
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ sanitize.js       â† æ•æ„Ÿä¿¡æ¯è„±æ•
â”‚       â””â”€â”€ logger.js
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Nodes.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NodeDetail.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Backups.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Scores.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Deploy.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Costs.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Events.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Terminal.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Settings.jsx
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ NodeCard.jsx
â”‚   â”‚       â”œâ”€â”€ ScoreRadar.jsx
â”‚   â”‚       â”œâ”€â”€ TrendChart.jsx
â”‚   â”‚       â””â”€â”€ EventLog.jsx
â”‚   â””â”€â”€ index.html
â””â”€â”€ README.md
```

---

## 15. å¼€å‘è®¡åˆ’ (ä¿®è®¢ç‰ˆ)

| Phase | å†…å®¹ | å¤©æ•° | ä¼˜å…ˆçº§ |
|-------|------|------|--------|
| **P0** | é¡¹ç›®åˆå§‹åŒ– + DB + åŸºç¡€API | 1 | ğŸ”´ |
| **P1** | èŠ‚ç‚¹æ³¨å†Œ + SSHæµ‹è¯• + çŠ¶æ€ç›‘æ§ | 2 | ğŸ”´ |
| **P2** | Dashboard UI (èŠ‚ç‚¹ç½‘æ ¼+æ¦‚è§ˆ) | 2 | ğŸ”´ |
| **P3** | Git å¤‡ä»½ç³»ç»Ÿ (GitHubé›†æˆ) | 3 | ğŸ”´ |
| **P4** | è¿˜åŸç³»ç»Ÿ + diff å¯¹æ¯” | 2 | ğŸŸ  |
| **P5** | æ™ºåŠ›è¯„ä¼°ç³»ç»Ÿ | 3 | ğŸŸ  |
| **P6** | è‡ªåŠ¨å›æ»š + å‘Šè­¦é€šçŸ¥ | 2 | ğŸŸ  |
| **P7** | ä¸€é”®å®‰è£… + é…ç½®æ¨¡æ¿ | 2 | ğŸŸ¡ |
| **P8** | è´¹ç”¨è¿½è¸ª + Webç»ˆç«¯ | 2 | ğŸŸ¡ |
| **P9** | ç¾åŒ– + ç§»åŠ¨ç«¯é€‚é… | 2 | ğŸŸ¢ |
| | **åˆè®¡** | **~21å¤©** | |

---

## 16. Review è®°å½•

### Review #1 (åˆç‰ˆ â†’ v2)
- âŒ å¤‡ä»½å­˜æœ¬åœ° â†’ âœ… Git + GitHub
- âŒ æ—  agent â†’ âœ… è½»é‡ shell agent
- âŒ å®‰å…¨æœªè€ƒè™‘ â†’ âœ… æ•æ„Ÿä¿¡æ¯è„±æ•

### Review #2 (v2 â†’ v3)
- âŒ æ™ºåŠ›æµ‹è¯•æ–¹æ¡ˆæ¨¡ç³Š â†’ âœ… 5ç»´åº¦è¯¦ç»†è®¾è®¡
- âŒ Git ç­–ç•¥æœªå®šä¹‰ â†’ âœ… åˆ†æ”¯+Tag ç­–ç•¥
- âŒ è¿˜åŸæ— ä¿æŠ¤ â†’ âœ… è¿˜åŸå‰è‡ªåŠ¨å¿«ç…§
- âŒ å‘Šè­¦æ— å…·ä½“æ ¼å¼ â†’ âœ… Telegram é€šçŸ¥æ¨¡æ¿
- â• æ–°å¢è´¹ç”¨è¿½è¸ªæ¨¡å—
- â• æ–°å¢ Web SSH ç»ˆç«¯
- â• æ–°å¢é…ç½®æ¨¡æ¿ç³»ç»Ÿ
- â• æ–°å¢äº‹ä»¶æ—¥å¿—ç³»ç»Ÿ

### Review #3 (v3 â†’ v4) - å¤‡ä»½å¢å¼º
- âŒ OCM è‡ªèº«æ•°æ®åº“æ— å¤‡ä»½ â†’ âœ… OCM DB ä¹Ÿçº³å…¥ Git å¤‡ä»½
- âŒ åªæœ‰ GitHub å•ç‚¹ â†’ âœ… GitHub + Google Drive åŒå¤‡ä»½
- â• Google Drive å¤‡ä»½ï¼Œ30å¤©ä¿ç•™ç­–ç•¥
- â• OCM å…ƒæ•°æ® (DB + é…ç½®) å¤‡ä»½

### Review #4 (v4 â†’ v5) - è¿ç»´å¢å¼º
- âŒ åˆå§‹åŒ–ä»…æè¿°æ­¥éª¤ â†’ âœ… 4æ­¥å‘å¯¼ + å®æ—¶è¿›åº¦ + OSå…¨è‡ªåŠ¨é…ç½®
- âŒ æ— Botç®¡ç†é¢æ¿ â†’ âœ… Token/æ¨¡å‹/Key é›†ä¸­ç®¡ç† + ä¸€æ‹¬æ“ä½œ
- âŒ æ— æµ‹è¯•ç¯å¢ƒæ¦‚å¿µ â†’ âœ… ãƒ†ã‚¹ãƒˆâ†’æ‰¿èªâ†’ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
- â• ã‚«ãƒŠãƒªã‚¢ãƒ‡ãƒ—ãƒ­ã‚¤
- â• èŠ‚ç‚¹è§’è‰²åˆ†ç±» (ç”Ÿäº§/æµ‹è¯•/å¤‡ç”¨)

### Review #5 (v5 â†’ v6) - Botæ§åˆ¶å±¤ + ç¨³å®šæ€§å¢å¼º

**æ¶æ„æ”¹è¿›:**
- âŒ åªæœ‰ Web UI æ“ä½œ â†’ âœ… Bot â†’ OCM API â†’ Nodes ä¸‰å±‚æ§åˆ¶
- âŒ æ— æ•…éšœéš”ç¦» â†’ âœ… å„å±‚ç‹¬ç«‹ï¼Œå•ç‚¹æ•…éšœä¸å½±å“å…¶ä»–å±‚
- âŒ æ—  Bot æŒ‡ä»¤ç³»ç»Ÿ â†’ âœ… Telegram è‡ªç„¶è¯­è¨€/å‘½ä»¤ æ§åˆ¶é›†ç¾¤

**ç¨³å®šæ€§æ”¹è¿›:**
- â• OCM Server è‡ªèº«å¥åº·æ£€æŸ¥ + è‡ªåŠ¨é‡å¯ (PM2/systemd)
- â• SSH è¿æ¥æ±  + è‡ªåŠ¨é‡è¿ + è¶…æ—¶å¤„ç†
- â• API æ“ä½œé˜Ÿåˆ— (é˜²æ­¢å¹¶å‘å†²çª)
- â• æ“ä½œç¡®è®¤æœºåˆ¶ (å±é™©æ“ä½œéœ€äºŒæ¬¡ç¡®è®¤)
- â• æ“ä½œå®¡è®¡æ—¥å¿— (è°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆ)
- â• WebSocket å®æ—¶çŠ¶æ€æ¨é€ (æ›¿ä»£è½®è¯¢)

**Bot æ§åˆ¶å±‚æ–°å¢:**
- â• OCM Bot: Telegram æŒ‡ä»¤ç³»ç»Ÿ
- â• å‘Šè­¦åŒé€šé“: Bot ä¸»åŠ¨é€šçŸ¥ + Web UI æ˜¾ç¤º
- â• è¿œç¨‹åº”æ€¥: æ‰‹æœºä¸Šé€šè¿‡ Bot æ“ä½œé›†ç¾¤

---

## 17. OCM Bot æ§åˆ¶å±‚ (v6 æ–°å¢)

### 17.1 Bot æŒ‡ä»¤è®¾è®¡

OCM Bot æ˜¯è¿è¡Œåœ¨ Master èŠ‚ç‚¹ä¸Šçš„ OpenClaw å®ä¾‹ï¼Œé€šè¿‡è°ƒç”¨ OCM Server API æ¥ç®¡ç†é›†ç¾¤ã€‚

**æŒ‡ä»¤åˆ†ç±»:**

```
ğŸ“Š æŸ¥çœ‹ç±» (åªè¯»ï¼Œæ— é£é™©)
  /status                    â€” é›†ç¾¤æ¦‚è§ˆ
  /status g3s-01             â€” å•èŠ‚ç‚¹çŠ¶æ€
  /nodes                     â€” èŠ‚ç‚¹åˆ—è¡¨
  /scores                    â€” æ™ºåŠ›è¯„åˆ†æ¦‚è§ˆ
  /costs                     â€” æœ¬æœˆè´¹ç”¨
  /events [n]                â€” æœ€è¿‘næ¡äº‹ä»¶

ğŸ’¾ å¤‡ä»½ç±» (ä½é£é™©)
  /backup g3s-01             â€” å¤‡ä»½å•èŠ‚ç‚¹
  /backup all                â€” å…¨é›†ç¾¤å¤‡ä»½
  /backups g3s-01            â€” æŸ¥çœ‹å¤‡ä»½å†å²
  /diff g3s-01               â€” æŸ¥çœ‹æœ€è¿‘å˜æ›´

ğŸ”„ æ“ä½œç±» (ä¸­é£é™©ï¼Œéœ€ç¡®è®¤)
  /restart g3s-01            â€” é‡å¯èŠ‚ç‚¹ OpenClaw
  /restart all               â€” é‡å¯å…¨é›†ç¾¤
  /update g3s-01             â€” å‡çº§ OpenClaw
  /deploy v1.8.3             â€” éƒ¨ç½²æ–°ç‰ˆæœ¬ (èµ°æµ‹è¯•æµç¨‹)
  /model g3s-01 claude-opus  â€” åˆ‡æ¢æ¨¡å‹
  /sync-config g3s-01â†’all    â€” åŒæ­¥é…ç½®

âš ï¸ å±é™©ç±» (é«˜é£é™©ï¼Œéœ€äºŒæ¬¡ç¡®è®¤)
  /restore g3s-01 tag:stable/2026-02-15  â€” è¿˜åŸåˆ°æŒ‡å®šç‰ˆæœ¬
  /rollback g3s-01           â€” å›æ»šåˆ°æœ€è¿‘ç¨³å®šç‰ˆ
  /reset g3s-01              â€” é‡ç½®èŠ‚ç‚¹ (æ…ç”¨)
  /delete-backup tag:xxx     â€” åˆ é™¤å¤‡ä»½

ğŸ§  æ™ºåŠ›ç±»
  /test g3s-01               â€” è§¦å‘æ™ºåŠ›æµ‹è¯•
  /test all                  â€” å…¨é›†ç¾¤æµ‹è¯•
  /scores g3s-01 --detail    â€” è¯¦ç»†è¯„åˆ†

ğŸ”‘ Keyç®¡ç†
  /keys                      â€” å…¨é›†ç¾¤Keyæ¦‚è§ˆ
  /keys g3s-01               â€” èŠ‚ç‚¹Keyåˆ—è¡¨
  /verify-keys               â€” éªŒè¯æ‰€æœ‰Key
```

### 17.2 è‡ªç„¶è¯­è¨€æ”¯æŒ

é™¤äº†å‘½ä»¤å¼ï¼ŒBot ä¹Ÿæ”¯æŒè‡ªç„¶è¯­è¨€:

```
ç”¨æˆ·: "g3s-01 çš„çŠ¶æ€æ€ä¹ˆæ ·ï¼Ÿ"
Bot:  ğŸŸ¢ G3S-01 åœ¨çº¿
      CPU: 12% | RAM: 45% | Disk: 55%
      OpenClaw: v1.8.2 | ğŸ§  95åˆ†
      æœ€åå¤‡ä»½: 2hå‰ | Bot: 2ä¸ªè¿è¡Œä¸­

ç”¨æˆ·: "æŠŠæ‰€æœ‰æœºå™¨éƒ½å¤‡ä»½ä¸€ä¸‹"
Bot:  å¼€å§‹å…¨é›†ç¾¤å¤‡ä»½...
      âœ… g3s-01 å®Œæˆ (2.1MB)
      âœ… g3s-02 å®Œæˆ (1.8MB)
      âœ… g3s-03 å®Œæˆ (2.3MB)
      ...
      ğŸ“¦ å…¨éƒ¨ 7/7 å®Œæˆï¼Œå·²æ¨é€åˆ° GitHub

ç”¨æˆ·: "g3s-04 å¥½åƒæœ‰é—®é¢˜ï¼Œå›æ»šä¸€ä¸‹"
Bot:  âš ï¸ ç¡®è®¤å›æ»š g3s-04 åˆ°æœ€è¿‘ç¨³å®šç‰ˆï¼Ÿ
      å½“å‰ç‰ˆæœ¬: v1.8.2 (æ™ºåŠ›: 45åˆ†)
      ç›®æ ‡ç‰ˆæœ¬: stable/2026-02-14 (æ™ºåŠ›: 92åˆ†)
      [ç¡®è®¤å›æ»š] [å–æ¶ˆ]

ç”¨æˆ·: [ç¡®è®¤å›æ»š]
Bot:  ğŸ”„ æ­£åœ¨å›æ»š g3s-04...
      1. âœ… åˆ›å»ºå½“å‰å¿«ç…§ (pre-rollback)
      2. âœ… åœæ­¢ OpenClaw
      3. âœ… è¿˜åŸæ–‡ä»¶
      4. âœ… é‡å¯ OpenClaw
      5. âœ… å¥åº·æ£€æŸ¥é€šè¿‡
      ğŸ‰ å›æ»šå®Œæˆï¼å½“å‰è¯„åˆ†å¾…ä¸‹æ¬¡æµ‹è¯•æ›´æ–°
```

### 17.3 ç¡®è®¤æœºåˆ¶

**ä½é£é™©æ“ä½œ:** ç›´æ¥æ‰§è¡Œ
- æŸ¥çœ‹çŠ¶æ€ã€å¤‡ä»½ã€æŸ¥çœ‹æ—¥å¿—

**ä¸­é£é™©æ“ä½œ:** å•æ¬¡ç¡®è®¤
- é‡å¯èŠ‚ç‚¹ã€åˆ‡æ¢æ¨¡å‹ã€åŒæ­¥é…ç½®
- Botå‘é€ [ç¡®è®¤] [å–æ¶ˆ] inlineæŒ‰é’®

**é«˜é£é™©æ“ä½œ:** äºŒæ¬¡ç¡®è®¤ + å®‰å…¨ç 
- è¿˜åŸã€å›æ»šã€é‡ç½®ã€åˆ é™¤
- ç¬¬ä¸€æ¬¡: [ç¡®è®¤æ“ä½œ]
- ç¬¬äºŒæ¬¡: "è¯·è¾“å…¥å®‰å…¨ç  XXXX ä»¥ç¡®è®¤" (4ä½éšæœºç )

### 17.4 å‘Šè­¦é€šçŸ¥

Bot ä¸»åŠ¨æ¨é€å‘Šè­¦:

```
ğŸ”´ [ç´§æ€¥] G3S-04 ç¦»çº¿
æ—¶é—´: 2026-02-15 14:30:25
æœ€ååœ¨çº¿: 5åˆ†é’Ÿå‰
æœ€åçŠ¶æ€: CPU 95%, RAM 88%
å¯èƒ½åŸå› : è¿‡è½½æˆ–æ­»æœº

[å°è¯•SSHè¿æ¥] [æŸ¥çœ‹æ—¥å¿—] [é™éŸ³1h]

---

ğŸŸ  [è­¦å‘Š] G3S-03 æ™ºåŠ›ä¸‹é™
è¯„åˆ†: 52/100 (ä¹‹å‰: 91/100)
â”œâ”€ è®°å¿†ä¸€è‡´æ€§: 5/20 âš ï¸
â”œâ”€ å·¥å…·ä½¿ç”¨: 8/20 âš ï¸
â”œâ”€ é€»è¾‘æ¨ç†: 15/20
â”œâ”€ å›å¤è´¨é‡: 12/20
â””â”€ äººæ ¼ä¸€è‡´æ€§: 12/20

[è‡ªåŠ¨å›æ»š] [æ‰‹åŠ¨æ£€æŸ¥] [å¿½ç•¥]

---

âœ… [æ¢å¤] G3S-04 é‡æ–°ä¸Šçº¿
ç¦»çº¿æ—¶é•¿: 12åˆ†é’Ÿ
å½“å‰çŠ¶æ€: CPU 8%, RAM 42%
è‡ªåŠ¨æ¢å¤åŸå› : çœ‹é—¨ç‹—é‡å¯
```

### 17.5 Bot æŠ€æœ¯å®ç°

```
OCM Bot = Master èŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ª OpenClaw å®ä¾‹
â”œâ”€â”€ ä¸“ç”¨ Telegram Bot (@yn_ocm_bot)
â”œâ”€â”€ ä¸“ç”¨ workspace (~/.openclaw/ws-ocm-bot/)
â”œâ”€â”€ SOUL.md: "ä½ æ˜¯OCMé›†ç¾¤ç®¡ç†Botï¼Œè´Ÿè´£ç®¡ç†Nå°OpenClawèŠ‚ç‚¹..."
â”œâ”€â”€ TOOLS.md: OCM API ç«¯ç‚¹æ–‡æ¡£
â””â”€â”€ Skills:
    â””â”€â”€ ocm-control/SKILL.md: å¦‚ä½•è°ƒç”¨ OCM API
```

OCM Bot é€šè¿‡ HTTP è°ƒç”¨ OCM Server API (localhost:3001):
```
# Bot å†…éƒ¨è°ƒç”¨ç¤ºä¾‹
curl http://localhost:3001/api/nodes/g3s-01/backups -X POST
curl http://localhost:3001/api/dashboard
curl http://localhost:3001/api/nodes/g3s-01/scores -X POST
```

---

## 18. ç¨³å®šæ€§è®¾è®¡ (v6 æ–°å¢)

### 18.1 æ•…éšœéš”ç¦»

```
æ•…éšœåœºæ™¯ â†’ å½±å“èŒƒå›´ â†’ æ¢å¤æ–¹å¼

OCM Bot å´©æºƒ
  â†’ Web UI æ­£å¸¸ï¼Œå®šæ—¶ä»»åŠ¡æ­£å¸¸ï¼ŒèŠ‚ç‚¹æ­£å¸¸
  â†’ PM2 è‡ªåŠ¨é‡å¯ Bot

OCM Server å´©æºƒ
  â†’ Bot æŒ‡ä»¤å¤±è´¥ï¼ŒWeb UI ä¸å¯ç”¨
  â†’ ä½†å„èŠ‚ç‚¹ OpenClaw ç‹¬ç«‹è¿è¡Œï¼Œä¸å—å½±å“
  â†’ PM2/systemd è‡ªåŠ¨é‡å¯ Server

å•ä¸ªèŠ‚ç‚¹å´©æºƒ
  â†’ ä»…è¯¥èŠ‚ç‚¹ Bot æœåŠ¡ä¸å¯ç”¨
  â†’ OCM æ£€æµ‹åˆ° â†’ å‘Šè­¦ â†’ å°è¯• SSH é‡å¯
  â†’ å…¶ä»–èŠ‚ç‚¹å®Œå…¨ä¸å—å½±å“

Master èŠ‚ç‚¹å´©æºƒ
  â†’ æ‰€æœ‰ç®¡ç†åŠŸèƒ½ä¸å¯ç”¨
  â†’ ä½†å„èŠ‚ç‚¹ OpenClaw ç‹¬ç«‹è¿è¡Œ!
  â†’ æ‰‹åŠ¨æ¢å¤ Master åä» GitHub/GDrive è¿˜åŸ OCM
```

### 18.2 çœ‹é—¨ç‹— (Watchdog)

```
OCM Server å†…å»ºçœ‹é—¨ç‹—:

æ¯ 60s æ£€æŸ¥:
â”œâ”€â”€ è‡ªèº« API æ˜¯å¦å“åº” â†’ å¦åˆ™æŠ¥å‘Šå¼‚å¸¸
â”œâ”€â”€ å„èŠ‚ç‚¹ SSH è¿é€šæ€§ â†’ è¶…æ—¶æ ‡è®° offline
â”œâ”€â”€ å„èŠ‚ç‚¹ OpenClaw è¿›ç¨‹çŠ¶æ€ â†’ æ­»äº†å°±å‘Šè­¦
â”œâ”€â”€ ç£ç›˜ç©ºé—´ â†’ ä¸è¶³å‘Šè­¦
â””â”€â”€ å†…å­˜ä½¿ç”¨ â†’ è¿‡é«˜å‘Šè­¦

æ¯ 5min æ£€æŸ¥:
â”œâ”€â”€ GitHub Push æ˜¯å¦æ­£å¸¸ â†’ å¦åˆ™å‘Šè­¦
â”œâ”€â”€ OCM Bot æ˜¯å¦å­˜æ´» â†’ å¦åˆ™å°è¯•é‡å¯
â””â”€â”€ å„èŠ‚ç‚¹æ—¶é’ŸåŒæ­¥ â†’ åå·®è¿‡å¤§å‘Šè­¦
```

### 18.3 æ“ä½œé˜Ÿåˆ—

é˜²æ­¢å¹¶å‘æ“ä½œå†²çª:

```
æ“ä½œé˜Ÿåˆ— (æ¯èŠ‚ç‚¹ç‹¬ç«‹):
â”œâ”€â”€ åŒä¸€èŠ‚ç‚¹çš„æ“ä½œæ’é˜Ÿæ‰§è¡Œ
â”œâ”€â”€ é˜²æ­¢: å¤‡ä»½ä¸­åˆè§¦å‘è¿˜åŸ
â”œâ”€â”€ è¶…æ—¶æœºåˆ¶: å•æ“ä½œæœ€é•¿ 5min
â””â”€â”€ é”å®šæ˜¾ç¤º: Web UI + Bot æ˜¾ç¤º "g3s-01 æ“ä½œä¸­..."

å…¨å±€æ“ä½œ (å¦‚å…¨é›†ç¾¤å¤‡ä»½):
â”œâ”€â”€ è·å–å…¨å±€é”
â”œâ”€â”€ å¹¶è¡Œæ‰§è¡Œå„èŠ‚ç‚¹ (ä½†æ¯èŠ‚ç‚¹ä¸²è¡Œ)
â””â”€â”€ æ±‡æ€»ç»“æœåé‡Šæ”¾é”
```

### 18.4 è‡ªåŠ¨æ¢å¤

```
èŠ‚ç‚¹ç¦»çº¿ â†’ æ£€æµ‹

5min å:
  â†’ SSH å°è¯•è¿æ¥
  â”œâ”€â”€ æˆåŠŸ â†’ æ£€æŸ¥ OpenClaw è¿›ç¨‹
  â”‚         â”œâ”€â”€ è¿è¡Œä¸­ â†’ æ ‡è®° online (å¯èƒ½æ˜¯ç½‘ç»œæŠ–åŠ¨)
  â”‚         â””â”€â”€ å·²æ­» â†’ é‡å¯ OpenClaw â†’ å‘Šè­¦
  â””â”€â”€ å¤±è´¥ â†’ å‘Šè­¦ "èŠ‚ç‚¹ä¸å¯è¾¾ï¼Œå¯èƒ½éœ€è¦ç‰©ç†æ£€æŸ¥"

15min åä»ç¦»çº¿:
  â†’ å‡çº§å‘Šè­¦çº§åˆ«
  â†’ è®°å½•äº‹ä»¶

1h åä»ç¦»çº¿:
  â†’ æ ‡è®°ä¸º critical
  â†’ å»ºè®®æ£€æŸ¥ç¡¬ä»¶
```

### 18.5 å®¡è®¡æ—¥å¿—

æ‰€æœ‰æ“ä½œè®°å½•:

```sql
CREATE TABLE IF NOT EXISTS audit_log (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  operator TEXT NOT NULL,         -- 'bot', 'web', 'cron', 'system'
  operator_detail TEXT,           -- 'telegram:8583883978', 'web:192.168.20.1'
  action TEXT NOT NULL,           -- 'backup', 'restore', 'restart', etc.
  target TEXT,                    -- 'g3s-01', 'all', 'account:3'
  params TEXT,                    -- JSON: æ“ä½œå‚æ•°
  result TEXT,                    -- 'success', 'failed', 'cancelled'
  error_message TEXT,
  duration_ms INTEGER,
  created_at INTEGER DEFAULT (strftime('%s','now') * 1000)
);
```

---

### Review #5 æ”¹å–„æ€»ç»“

| é—®é¢˜ | æ”¹å–„ |
|------|------|
| åªèƒ½é€šè¿‡ Web UI æ“ä½œ | Bot + Web UI + å®šæ—¶ä»»åŠ¡ ä¸‰å…¥å£ |
| æ— æ•…éšœéš”ç¦»è®¾è®¡ | ä¸‰å±‚ç‹¬ç«‹ï¼Œé€çº§é™çº§ |
| å¹¶å‘æ“ä½œå¯èƒ½å†²çª | æ“ä½œé˜Ÿåˆ— + èŠ‚ç‚¹é” |
| æ— æ“ä½œç¡®è®¤ | ä½/ä¸­/é«˜ ä¸‰çº§ç¡®è®¤æœºåˆ¶ |
| èŠ‚ç‚¹ç¦»çº¿æ— è‡ªåŠ¨å¤„ç† | çœ‹é—¨ç‹— + 5/15/60min å‡çº§å‘Šè­¦ |
| æ— æ“ä½œå®¡è®¡ | å…¨é‡å®¡è®¡æ—¥å¿— |
| å‘Šè­¦åªæœ‰ Web æ˜¾ç¤º | Bot ä¸»åŠ¨æ¨é€ + å†…è”æŒ‰é’®æ“ä½œ |

### å¾…ä¼˜åŒ– (æœªæ¥)
- [ ] å¤š Master é«˜å¯ç”¨ (ä¸»ä»åˆ‡æ¢)
- [ ] è·¨èŠ‚ç‚¹è´Ÿè½½å‡è¡¡ (Bot è¯·æ±‚åˆ†å‘)
- [ ] è‡ªåŠ¨æ‰©ç¼©å®¹
- [ ] Prometheus + Grafana é›†æˆ
- [ ] ç§»åŠ¨ App (React Native)
- [ ] è¯­éŸ³æŒ‡ä»¤ (é€šè¿‡ Telegram è¯­éŸ³æ¶ˆæ¯)
